(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[809,644],{35796:function(t,n,e){"use strict";e.d(n,{d:function(){return s}});var i=e(4942),o=e(45624);class s extends o.J5{constructor(t){super(),(0,i.Z)(this,"clientId",void 0),this.clientId=t.clientId}async authenticateUser(){var t;if(!this.provider||null===(t=this.chainConfig)||void 0===t||!t.chainId)throw o.RM.notConnectedError();const{chainNamespace:n,chainId:e}=this.chainConfig;if(this.status!==o.MP.CONNECTED)throw o.RM.notConnectedError("Not connected with wallet, Please login/connect first");const i=await this.provider.request({method:"eth_accounts"});if(i&&i.length>0){const t=(0,o.Cb)(i[0],this.name);if(t){if(!(0,o.$E)(t))return{idToken:t}}const s={domain:window.location.origin,uri:window.location.href,address:i[0],chainId:parseInt(e,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:(new Date).toISOString()},r=await(0,o.tV)(s,n),a=await this.provider.request({method:"personal_sign",params:[r,i[0]]}),c=await(0,o.rn)(n,a,r,this.name,this.sessionTime,this.clientId);return(0,o.Fr)(i[0],this.name,c),{idToken:c}}throw o.RM.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnect(){if(this.status!==o.MP.CONNECTED)throw o.RM.disconnectionError("Not connected with wallet");const t=await this.provider.request({method:"eth_accounts"});t&&t.length>0&&(0,o.qz)(t[0],this.name)}}},21357:function(t,n,e){"use strict";e.r(n),e.d(n,{WalletConnectV1Adapter:function(){return d}});var i=e(4942),o=e(71516),s=e(45624),r=e(35796),a=e(52062);const c=[{name:"Rainbow",chains:[s.EN.EIP155],logo:"https://images.web3auth.io/login-rainbow.svg",mobile:{native:"rainbow:",universal:"https://rnbwapp.com"},desktop:{native:"",universal:""}},{name:"MetaMask",chains:[s.EN.EIP155],logo:"https://images.web3auth.io/login-metamask.svg",mobile:{native:"metamask:",universal:"https://metamask.app.link"},desktop:{native:"",universal:""}}];function h(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}class d extends r.d{constructor(t){super(t),(0,i.Z)(this,"name",s.rW.WALLET_CONNECT_V1),(0,i.Z)(this,"adapterNamespace",s.yk.EIP155),(0,i.Z)(this,"currentChainNamespace",s.EN.EIP155),(0,i.Z)(this,"type",s.hN.EXTERNAL),(0,i.Z)(this,"adapterOptions",void 0),(0,i.Z)(this,"status",s.MP.NOT_READY),(0,i.Z)(this,"adapterData",{uri:"",extensionAdapters:c}),(0,i.Z)(this,"connector",null),(0,i.Z)(this,"wcProvider",null),(0,i.Z)(this,"rehydrated",!1),this.adapterOptions=function(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?h(Object(e),!0).forEach((function(n){(0,i.Z)(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):h(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}({},t),this.chainConfig=t.chainConfig||null,this.sessionTime=t.sessionTime||86400}get connected(){var t;return!(null===(t=this.connector)||void 0===t||!t.connected)}get provider(){var t;return(null===(t=this.wcProvider)||void 0===t?void 0:t.provider)||null}set provider(t){throw new Error("Not implemented")}async init(){super.checkInitializationRequirements(),this.chainConfig||(this.chainConfig=(0,s.h2)(s.EN.EIP155,1)),this.connector=this.getWalletConnectInstance(),this.wcProvider=new a.WalletConnectProvider({config:{chainConfig:this.chainConfig},connector:this.connector}),this.emit(s.n2.READY,s.rW.WALLET_CONNECT_V1),this.status=s.MP.READY,s.cM.debug("initializing wallet connect v1 adapter"),this.connector.connected&&(this.rehydrated=!0,await this.onConnectHandler({accounts:this.connector.accounts,chainId:this.connector.chainId}))}async connect(){if(super.checkConnectionRequirements(),!this.connector)throw s.Ty.notReady("Wallet adapter is not ready yet");if(this.connected)return await this.onConnectHandler({accounts:this.connector.accounts,chainId:this.connector.chainId}),this.provider;if(this.status!==s.MP.CONNECTING){var t,n;if(null!==(t=this.adapterOptions.adapterSettings)&&void 0!==t&&t.qrcodeModal)this.connector=this.getWalletConnectInstance(),this.wcProvider=new a.WalletConnectProvider({config:{chainConfig:this.chainConfig,skipLookupNetwork:null===(n=this.adapterOptions.adapterSettings)||void 0===n?void 0:n.skipNetworkSwitching},connector:this.connector});await this.createNewSession(),this.status=s.MP.CONNECTING,this.emit(s.n2.CONNECTING,{adapter:s.rW.WALLET_CONNECT_V1})}return new Promise(((t,n)=>{if(!this.connector)return n(s.Ty.notReady("Wallet adapter is not ready yet"));this.connector.on("modal_closed",(async()=>(this.status=s.MP.READY,this.emit(s.n2.READY,s.rW.WALLET_CONNECT_V1),n(new Error("User closed modal")))));try{this.connector.on("connect",(async(n,e)=>(n&&this.emit(s.n2.ERRORED,n),s.cM.debug("connected event emitted by web3auth"),await this.onConnectHandler(e.params[0]),t(this.provider))))}catch(e){s.cM.error("Wallet connect v1 adapter error while connecting",e),this.status=s.MP.READY,this.rehydrated=!0,this.emit(s.n2.ERRORED,e),n(e instanceof s.up?e:s.RM.connectionError(`Failed to login with wallet connect: ${(null===e||void 0===e?void 0:e.message)||""}`))}}))}setAdapterSettings(t){this.status!==s.MP.READY&&(null!==t&&void 0!==t&&t.sessionTime&&(this.sessionTime=t.sessionTime),null!==t&&void 0!==t&&t.clientId&&(this.clientId=t.clientId))}async getUserInfo(){if(!this.connected)throw s.RM.notConnectedError("Not connected with wallet, Please login/connect first");return{}}async disconnect(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};const{cleanup:n}=t;if(!this.connector||!this.connected)throw s.RM.notConnectedError("Not connected with wallet");await super.disconnect(),await this.connector.killSession(),this.rehydrated=!1,n?(this.connector=null,this.status=s.MP.NOT_READY,this.wcProvider=null):this.status=s.MP.READY,this.emit(s.n2.DISCONNECTED)}async addChain(t){try{var n;if(!this.wcProvider)throw s.Ty.notReady("Wallet adapter is not ready yet");const e=null===(n=this.adapterOptions.adapterSettings)||void 0===n?void 0:n.networkSwitchModal;e&&await e.addNetwork({chainConfig:t,appOrigin:window.location.hostname}),await this.wcProvider.addChain(t)}catch(e){s.cM.error(e)}}async switchChain(t,n){var e;if(!this.wcProvider)throw s.Ty.notReady("Wallet adapter is not ready yet");const i=null===(e=this.adapterOptions.adapterSettings)||void 0===e?void 0:e.networkSwitchModal;i&&await i.switchNetwork({currentChainConfig:n,newChainConfig:t,appOrigin:window.location.hostname}),await this.wcProvider.switchChain({chainId:n.chainId,lookup:!1,addChain:!1})}async createNewSession(){var t,n;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{forceNewSession:!1};if(!this.connector)throw s.Ty.notReady("Wallet adapter is not ready yet");if(e.forceNewSession&&this.connector.pending&&await this.connector.killSession(),null===(t=this.adapterOptions)||void 0===t||null===(n=t.adapterSettings)||void 0===n||!n.qrcodeModal)return new Promise(((t,n)=>{var e;if(!this.connector)return n(s.Ty.notReady("Wallet adapter is not ready yet"));s.cM.debug("creating new session for web3auth wallet connect"),this.connector.on("display_uri",(async(e,i)=>{var o;if(e)return this.emit(s.n2.ERRORED,s.RM.connectionError("Failed to display wallet connect qr code")),n(e);const r=i.params[0];return this.updateAdapterData({uri:r,extensionAdapters:c}),null===(o=this.connector)||void 0===o||o.off("display_uri"),t()})),this.connector.createSession({chainId:parseInt((null===(e=this.chainConfig)||void 0===e?void 0:e.chainId)||"0x1",16)}).catch((t=>(s.cM.error("error while creating new wallet connect session",t),this.emit(s.n2.ERRORED,t),n(t))))}));var i;await this.connector.createSession({chainId:parseInt((null===(i=this.chainConfig)||void 0===i?void 0:i.chainId)||"0x1",16)})}async onConnectHandler(t){if(!this.connector||!this.wcProvider)throw s.Ty.notReady("Wallet adapter is not ready yet");if(!this.chainConfig)throw s.Ty.invalidParams("Chain config is not set");const{chainId:n}=t;if(s.cM.debug("connected chainId in hex"),n!==parseInt(this.chainConfig.chainId,16)){var e,i,o;const t=(0,s.h2)(s.EN.EIP155,n)||{chainId:`0x${n.toString(16)}`,displayName:"Unknown Network"},a=null===(e=this.adapterOptions.adapterSettings)||void 0===e?void 0:e.qrcodeModal;if(!a||a&&(null===(i=this.adapterOptions)||void 0===i||null===(o=i.adapterSettings)||void 0===o||!o.skipNetworkSwitching))try{await this.addChain(this.chainConfig),await this.switchChain(t,this.chainConfig),this.connector=this.getWalletConnectInstance()}catch(r){return s.cM.error("error while chain switching",r),await this.createNewSession({forceNewSession:!0}),this.emit(s.n2.ERRORED,s.Ty.fromCode(5e3,`Not connected to correct network. Expected: ${this.chainConfig.displayName}, Current: ${(null===t||void 0===t?void 0:t.displayName)||n}, Please switch to correct network from wallet`)),this.status=s.MP.READY,void(this.rehydrated=!0)}}await this.wcProvider.setupProvider(this.connector),this.subscribeEvents(this.connector),this.status=s.MP.CONNECTED,this.emit(s.n2.CONNECTED,{adapter:s.rW.WALLET_CONNECT_V1,reconnected:this.rehydrated})}subscribeEvents(t){t.on("session_update",(async t=>{t&&this.emit(s.n2.ERRORED,t)}))}getWalletConnectInstance(){const t=this.adapterOptions.adapterSettings||{};return t.bridge=t.bridge||"https://bridge.walletconnect.org",new o.Z(t)}}},27790:function(){},88924:function(){},55024:function(){}}]);